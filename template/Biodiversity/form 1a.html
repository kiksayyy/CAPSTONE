<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EcoStats</title>
  <link rel="stylesheet" href="../styles.css">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
</head>
<body>
  <header class="header">
    <div class="logo-section">
      <img src="../homepage/assets/logo.png" alt="Logo">
      <h1 class="logo-name">ECOSTATS</h1>
    </div>
    <nav class="nav-links">
      <a href="../homepage/homepage.html">Home</a>
      <a href="../dashboard/dashboard.html">Dashboard</a>
      <a href="../reports/reports.html">Reports</a>
    </nav>
    <div class="search-container">
      <input type="text" placeholder="Search..." id="search-bar">
      <i class='bx bx-search'></i>
    </div>
    <div class="user-profile" id="user-profile">
      <i class='bx bx-user'></i>
      <div class="dropdown" id="dropdown">
        <a href="#" id="sign-in">Sign In</a>
        <a href="#" id="logout">Logout</a>
      </div>
    </div>
  </header>
  
  <aside class="sidebar">
    <h2 class="sidebar-title">REPORTS</h2>
    <div class="dropdown-container">
      <button class="dropdown-btn">Land Management<i class='bx bx-chevron-down'></i></button>
      <div class="dropdown-content">
        <a href="#report1" onclick="showContent('report1')">Report 1</a>
        <a href="#report2" onclick="showContent('report2')">Report 2</a>
      </div>
    </div>
    <div class="dropdown-container">
      <button class="dropdown-btn">Forestry Management<i class='bx bx-chevron-down'></i></button>
      <div class="dropdown-content">
        <a href="#report3" onclick="showContent('report3')">Report 3</a>
        <a href="#report4" onclick="showContent('report4')">Report 4</a>
      </div>
    </div>
    <div class="dropdown-container">
      <button class="dropdown-btn">Biodiversity Management<i class='bx bx-chevron-down'></i></button>
      <div class="dropdown-content">
        <a href="#report5" onclick="showContent('report5')">Report 5</a>
        <a href="#report6" onclick="showContent('report6')">Report 6</a>
      </div>
    </div>
  </aside>
  
  <main class="main-content">

    <div class="table-container">
      
      <div class="button-container">
        <button id="edit-btn" onclick="window.location.href='./edit.html';">Edit</button>
        <i class='bx bx-download' id="download-btn"></i>
        <i class='bx bx-printer' id="print-btn"></i>
      </div>

      <table id="Form1">
        <thead>
          <tr>
            <th colspan="9">
              <h3>CENRO: PENRO: MARINDUQUE</h3>
              <h3>REGION: IV-B</h3>
            </th>
          </tr>
          <tr>
            <th>
              <h5>Function: Management and Development of Protected Areas</h5>
              <h5>Activity: Monitoring of Protected Area Visitors</h5>
            </th>
            <th colspan="7">
              <h4>PROTECTED AREAS, WILDLIFE AND COASTAL ZONE MANAGEMENT SERVICE Statistical Report</h4>
              <h5>1st Quarter CY 2023</h5>
            </th>
            <th>
              <h5>DENR Statistical Form 5</h5>
              <h5>PAWCZMS Statistical Form 1a</h5>
            </th>
          </tr>
          <tr>
            <th rowspan="3">Protected Area</th>
            <th colspan="3">Local</th>
            <th colspan="3">Foreign</th>
            <th rowspan="3">Total Number of Visitors</th>
            <th rowspan="3">Remarks</th>
          </tr>
          <tr>
            <th colspan="2">Sex</th>
            <th rowspan="2">Total</th>
            <th colspan="2">Sex</th>
            <th rowspan="2">Total</th>
          </tr>
          <tr>
            <th>M</th>
            <th>F</th>
            <th>M</th>
            <th>F</th>
          </tr>
        </thead>
        <tbody>
          <!-- Example rows to fill table -->
          <tr>
            <td>Area Name</td>
            <td>5</td>
            <td>10</td>
            <td>15</td>
            <td>3</td>
            <td>7</td>
            <td>10</td>
            <td>25</td>
            <td>Some remarks here</td>
          </tr>
          <!-- Additional rows can be added here -->
        </tbody>
      </table>

      <table style="margin-top: 20px;">
        <tr>
          <td>Prepared by:</td>
          <td>Reviewed by:</td>
          <td>Approved by:</td>
        </tr>
        <tr contenteditable="true">
          <td>Name<br>Position</td>
          <td>Name<br>Position</td>
          <td>Name<br>Position</td>
        </tr>
      </table>
    </div>
  </main>
  <script>
  // Edit button function
    document.getElementById('edit-btn').addEventListener('click', function() {
      const contentEditable = document.querySelectorAll('[contenteditable="true"]');
      contentEditable.forEach(cell => {
        cell.contentEditable = cell.contentEditable === "true" ? "false" : "true";
        if (cell.contentEditable === "true") {
          cell.style.border = '1px solid blue';  // Indicate editable state
        } else {
          cell.style.border = '1px solid transparent';  // Remove border
        }
      });
    });

  // Print button function
    document.getElementById('print-btn').addEventListener('click', function() {
  const content = document.querySelector('.main-content'); 
  
  const buttonContainer = content.querySelector('.button-container');
  if (buttonContainer) {
    buttonContainer.remove();
  }

  
  const printWindow = window.open('', '', 'height=600,width=800');
  printWindow.document.write('<html><head><title>Print</title>');
  printWindow.document.write('<link rel="stylesheet" href="../styles.css">');
  printWindow.document.write('</head><body >');
  printWindow.document.write(content.innerHTML); 
  printWindow.document.write('</body></html>');
  printWindow.document.close();
  printWindow.focus(); 
  printWindow.print(); 
});

  // Download button function
    document.getElementById('download-btn').addEventListener('click', function () {
    // Reference the table container (main content)
    const content = document.querySelector('.table-container');

    // remove button when downloading the files
    const buttonContainer = content.querySelector('.button-container');
    if (buttonContainer) {
      buttonContainer.remove();
    }

    
    html2canvas(content, {
      scale: 2, 
      onrendered: function (canvas) {
        
        const { jsPDF } = window.jspdf;
        const pdfFormat = 'a4';
        const imgWidth = canvas.width;
        const imgHeight = canvas.height;
        const imgRatio = imgWidth / imgHeight;
        const isLandscape = imgRatio > 1;

        const pdf = new jsPDF({
          orientation: isLandscape ? 'landscape' : 'portrait',
          unit: 'mm',
          format: pdfFormat
        });

        const pdfWidth = pdf.internal.pageSize.getWidth();
        const pdfHeight = pdf.internal.pageSize.getHeight();

        let pdfImageWidth = pdfWidth;
        let pdfImageHeight = pdfWidth / imgRatio;

        if (pdfImageHeight > pdfHeight) {
          pdfImageHeight = pdfHeight;
          pdfImageWidth = pdfHeight * imgRatio;
        }

        pdf.addImage(canvas.toDataURL('image/jpeg', 1.0), 'JPEG', 0, 0, pdfImageWidth, pdfImageHeight);

        pdf.save('report.pdf');
      }
    });
  });
  </script>

  <script>
    function showContent(sectionId) {
      const sections = document.querySelectorAll('.section');
      sections.forEach(section => {
        section.style.display = section.id === sectionId ? 'block' : 'none';
      });
    }

    const dropdownButtons = document.querySelectorAll('.dropdown-btn');
    dropdownButtons.forEach(button => {
      button.addEventListener('click', function() {
        this.classList.toggle('active');
        const dropdownContent = this.nextElementSibling;
        dropdownContent.style.display = dropdownContent.style.display === 'block' ? 'none' : 'block';
      });
    });

    document.getElementById('user-profile').addEventListener('click', function () {
      const dropdown = document.getElementById('dropdown');
      dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    });

    window.addEventListener('click', function (event) {
      const dropdown = document.getElementById('dropdown');
      if (!document.getElementById('user-profile').contains(event.target)) {
        dropdown.style.display = 'none';
      }
    });
  </script>
</body>
</html>
